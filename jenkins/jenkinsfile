#!groovy

// Run docker build

properties([disableConcurrentBuilds()])

pipeline {

    agent { 

        label 'master'

        }


    options {

        buildDiscarder(logRotator(numToKeepStr: '10', artifactNumToKeepStr: '10'))

        timestamps()

 }

    stages {

        stage("docker login") {

            steps {

                echo " ============== docker login =================="

                withCredentials([usernamePassword(credentialsId: 'dockerhub_hovops', usernameVariable: 'hovo14', passwordVariable: 'fearme1$')]) {

                    sh """

                    docker login -u $USERNAME -p $PASSWORD

                    """
   
             }
  
          }

     }


    stages {
     
        stage("create docker image") {

            steps {

                echo " ============== start building image =================="

                dir ('docker') {

                sh 'docker build -t hovops/nginx  . '

                }

             }

          }

stage("docker push") {

            steps {

                echo " ============== start pushing image =================="

                sh '''

                docker push semaev/hovops/gninx

                '''
      
         }

      }

   }

}
